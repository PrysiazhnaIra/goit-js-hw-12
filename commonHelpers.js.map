{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function searchImage(query, page = 1, perPage) {\n    const BASE_URL = 'https://pixabay.com/api/';\n\n    const params = new URLSearchParams({\n        key: '44028683-118753c7a8296875ea6775d6e',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n    });\n\n    const url = `${BASE_URL}?${params}`;\n\n    return await axios.get(url);\n}","function imageTemplate(image){\n    return `\n    <div class=\"gallery_block\">\n    <a href=\"${image.largeImageURL}\">\n    <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"picture\"></a>\n    <ul class=\"property_list\">\n    <li class=\"property_elem\">Likes <span class=\"span_property\">${image.likes}</span></li>\n    <li class=\"property_elem\">Views <span class=\"span_property\">${image.views}</span></li>\n    <li class=\"property_elem\">Comments <span class=\"span_property\">${image.comments}</span></li>\n    <li class=\"property_elem\">Downloads <span class=\"span_property\">${image.downloads}</span></li>\n    </ul>\n    </div>`;\n    \n}\n\nexport function imagesTemplate(arr) {\n    return arr.map(imageTemplate).join('');\n}","import {searchImage} from './js/pixabay-api.js';\nimport {imagesTemplate} from './js/render-function.js';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nvar lightbox = new SimpleLightbox('.gallery_block a', {captionsData: \"alt\", captionDelay: 250});\n\nconst myForm = document.querySelector(\".form\");\nconst imagesList = document.querySelector('.images_container');\n\nconst spinner = document.querySelector(\".loader\");\nconst showMore = document.querySelector(\".btn_more_block\");\n\nlet currentSearchQuery = '';\nlet page = 1;\nlet perPage = 15;\n\nfunction scrollShiftImages() {\n    const galleryItem = document.querySelector('.gallery_block');\n    const galleryItemHeight = galleryItem.getBoundingClientRect().height;\n  \n    window.scrollBy({\n        top: galleryItemHeight * 2,\n        behavior: 'smooth'\n    });\n}\n\nasync function fetchImages(query, page) {\n    if(!query) {\n        iziToast.warning({\n            title: 'Warning',\n            message: 'You should input something',\n            position: 'topCenter',\n        });\n\n        showMore.hidden = true;\n\n    } else {\n        spinner.hidden = false;\n\n        try {\n            let data = await searchImage(query, page, perPage);\n\n            if(data.data.hits.length != 0) {\n                const markup = imagesTemplate(data.data.hits);\n                \n                imagesList.insertAdjacentHTML('beforeend', markup);\n                lightbox.refresh();\n\n                page +=1;\n\n                showMore.hidden = false;\n\n                let totalHits = data.data.totalHits;\n\n                const totalPages = Math.ceil(totalHits / perPage);\n            \n                if (page >= totalPages) {\n                    showMore.hidden = true;\n                    return iziToast.info({\n                      position: \"topCenter\",\n                      message: \"We're sorry, but you've reached the end of search results.\"\n                    });\n                  }\n\n            } else {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                    position: 'topCenter',\n                });\n\n                showMore.hidden = true;\n            }\n        } catch(error) {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Failed to fetch data. Please try again later!',\n                    position: 'topCenter',\n                });\n        } finally {\n                spinner.hidden = true;\n        }\n    }  \n}\n\nfunction resetGallery() {\n    imagesList.innerHTML = \"\";\n    page = 1;\n    currentSearchQuery = \"\";\n}\n\nmyForm.addEventListener(\"submit\", (event) => {\n    event.preventDefault();\n\n    resetGallery();\n    const query = event.target.elements.query.value.trim();\n\n    currentSearchQuery = query;\n\n    fetchImages(query, page);\n});\n\nshowMore.addEventListener('click', (event) => {\n    event.preventDefault();\n\n    const query = myForm.elements.query.value.trim();\n\n    if(query === currentSearchQuery) {\n        page += 1; \n        fetchImages(query, page).then(() => scrollShiftImages());    \n    } else {\n        resetGallery();\n        currentSearchQuery = query;  \n        fetchImages(query, page);\n    }\n  });\n\n\n\n\n\n"],"names":["searchImage","query","page","perPage","BASE_URL","params","url","axios","imageTemplate","image","imagesTemplate","arr","lightbox","SimpleLightbox","myForm","imagesList","spinner","showMore","currentSearchQuery","scrollShiftImages","galleryItemHeight","fetchImages","iziToast","data","markup","totalHits","totalPages","resetGallery","event"],"mappings":"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"}